{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('.searchInput');\nconst searchButton = document.querySelector('.searchButton');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreContainer = document.querySelector('.load-more-container');\nconst loadMoreButton = document.querySelector('.load-more-btn');\nconst loadMoreLoader = document.querySelector('.load-more-loader');\n\nconst API_KEY = '51442110-4fde2839a6cf4cc45b6823f02';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nlet currentPage = 1;\nconst perPage = 40;\nlet totalHits = 0;\nlet currentQuery = \"\";\n\nlet lightbox = new SimpleLightbox('.gallery a.gallery-link', {\n  navText: ['❮', '❯'],\n  captionsData: 'alt',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  close: true,\n  closeText: '×',\n  animationSlide: true,\n  animationSpeed: 250,\n  enableKeyboard: true,\n  overlay: true,\n  overlayOpacity: 0.8,\n  sourceAttr: 'href',\n  zoom: false,\n});\n\nfunction hideLoader(loaderElement) {\n    loaderElement.classList.add('is-hidden');\n}\n\nfunction showLoader(loaderElement) {\n    loaderElement.classList.remove('is-hidden');\n}\n\nfunction createGalleryMarkup(images) {\n  return images\n    .map(image => {\n      return `\n        <li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n            </a>\n            <div class=\"image-info\">\n                <p class=\"info\"><b>Likes</b>${image.likes}</p>\n                <p class=\"info\"><b>Views</b>${image.views}</p>\n                <p class=\"info\"><b>Comments</b>${image.comments}</p>\n                <p class=\"info\"><b>Downloads</b>${image.downloads}</p>\n            </div>\n        </li>`;\n    })\n    .join('');\n}\n\nasync function fetchImages(query, page) { \n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page: page,\n        per_page: perPage,\n    });\n\n    try {\n        const response = await axios.get(`${BASE_URL}?${searchParams}`);\n        return response.data;\n    } catch (error) { \n        console.error('Error fetching images:', error);\n        iziToast.error({\n            title: 'Error',\n            message: `An error occurred while fetching images: ${error.message}`,\n            position: 'topRight',\n        });\n        throw error;\n    }\n}\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n\n  const query = searchInput.value.trim();\n\n  if (query === '') {\n    iziToast.error({\n      message: 'Please enter a search term.',\n      position: 'topRight',\n      backgroundColor: '#EF4040',\n      messageColor: 'white',\n      progressBarColor: '#B51B1B',\n      closeOnClick: true,\n      closeOnEscape: true,\n      close: true,\n      timeout: 3000,\n      maxWidth: '450px',\n    });\n    return;\n  }\n\n    currentPage = 1;\n    currentQuery = query;\n    gallery.innerHTML = '';\n    hideLoader(loadMoreButton);\n    showLoader(loader);\n\n    try {\n        const data = await fetchImages(currentQuery, currentPage);\n        totalHits = data.totalHits;\n        const images = data.hits;\n\n        if (images.length === 0) {\n            iziToast.error({\n                message:\n                    'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n                backgroundColor: '#EF4040',\n                messageColor: 'white',\n                progressBarColor: '#B51B1B',\n                closeOnClick: true,\n                closeOnEscape: true,\n                close: true,\n                timeout: 3000,\n                maxWidth: '450px',\n            });\n            return;\n        }\n\n        gallery.innerHTML = createGalleryMarkup(images);\n        lightbox.refresh();\n        \n        const totalPage = Math.ceil(totalHits / perPage);\n        if (totalPage > 1) {\n            showLoader(loadMoreButton);\n            loadMoreContainer.classList.remove('is-hidden');\n        } else {\n            iziToast.info({\n                message: `We're sorry, but you've reached the end of search results.`,\n                position: 'topRight',\n                backgroundColor: '#3A8EBA',\n                messageColor: 'white',\n                progressBarColor: '#1B5BB5',\n                closeOnClick: true,\n                closeOnEscape: true,\n                close: true,\n                timeout: 3000,\n                maxWidth: '450px',\n            });\n        }\n        \n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: `An error occurred while fetching images: ${error.message}`,\n            position: 'topRight',\n        });\n        console.error('Error fetching images:', error);\n    } finally { \n        hideLoader(loader);\n        searchInput.value = '';\n    }\n    \n});\n\n\nloadMoreButton.addEventListener(\"click\", async () => { \n    currentPage += 1;\n    hideLoader(loadMoreButton);\n    showLoader(loadMoreLoader);\n\n    try {\n        const data = await fetchImages(currentQuery, currentPage);\n        const images = data.hits;\n\n        const markup = createGalleryMarkup(images);\n        gallery.insertAdjacentHTML('beforeend', markup);\n        lightbox.refresh();\n\n        const galleryItemHeight = gallery.firstElementChild.getBoundingClientRect().height;\n        window.scrollBy({\n            top: galleryItemHeight * 2,\n            behavior: 'smooth',\n        });\n\n        if (currentPage * 40 >= totalHits) {\n            hideLoader(loadMoreButton);\n            iziToast.info({\n                message: `We're sorry, but you've reached the end of search results.`,\n                position: 'topRight',\n                backgroundColor: '#3A8EBA',\n                messageColor: 'white',\n                progressBarColor: '#1B5BB5',\n                closeOnClick: true,\n                closeOnEscape: true,\n                close: true,\n                timeout: 3000,\n                maxWidth: '450px',\n            });\n        } else {\n            showLoader(loadMoreButton);\n        }\n\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: `An error occurred while fetching more images: ${error.message}`,\n            position: 'topRight',\n        });\n        console.error('Error fetching more images:', error);\n    } finally { \n        hideLoader(loadMoreLoader);\n    }\n\n});"],"names":["form","searchInput","gallery","loader","loadMoreContainer","loadMoreButton","loadMoreLoader","API_KEY","BASE_URL","currentPage","perPage","totalHits","currentQuery","lightbox","SimpleLightbox","hideLoader","loaderElement","showLoader","createGalleryMarkup","images","image","fetchImages","query","page","searchParams","axios","error","iziToast","event","data","markup","galleryItemHeight"],"mappings":"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"}